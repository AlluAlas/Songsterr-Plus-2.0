import{_ as t,v as e,i as s,b as i}from"./preact.89f2d999.js";import{v as o,y as a,Y as n,n as r,c1 as l,K as c,bY as g,c2 as d,H as p,F as h,E as u,L as m}from"./index.0e02c5ee.js";import{b as f}from"./user.151b6a3c.js";import{g as w,a as _,s as S}from"./google.7600d979.js";import{P as v}from"./Panel.3ed0232a.js";import{t as y,s as b,a as z}from"./Section.fdb522b8.js";class N extends t{render(){const t=this.props.className;return e("svg",{width:40,height:40,viewBox:"0 0 26 26",className:t},e("g",{fill:"none",fillRule:"evenodd"},e("rect",{width:"26",height:"26",fill:"#FFF",rx:"2"}),e("g",{fill:"#000"},e("path",{fill:"#EA4335",d:"M13 7.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C17.46 4.89 15.43 4 13 4 9.48 4 6.44 6.02 4.96 8.96l2.91 2.26C8.6 9.05 10.62 7.48 13 7.48z"}),e("path",{fill:"#4285F4",d:"M21.64 13.2c0-.74-.06-1.28-.19-1.84H13v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z"}),e("path",{fill:"#FBBC05",d:"M7.88 14.78a5.54 5.54 0 0 1-.3-1.78c0-.62.11-1.22.29-1.78L4.96 8.96A9.008 9.008 0 0 0 4 13c0 1.45.35 2.82.96 4.04l2.92-2.26z"}),e("path",{fill:"#34A853",d:"M13 22c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74l-2.91 2.26C6.45 19.98 9.48 22 13 22z"}),e("path",{fill:"none",d:"M4 4h18v18H4z"}))))}}const P=t=>{let{onClick:s,processing:i,disabled:r,title:l,id:c}=t;return e("button",{id:c,className:o.google,onClick:s,disabled:r||i},i&&e(a,{width:25,height:20,fill:"#fff",className:n.google}),!i&&e(N,{className:o.googleIcon}),e("span",null,l))};var C={title:y+" z912",sectionGoogle:b+" z9263",separator:"z910q",sectionSignin:b+" z925t",actions:z+" z9310",sectionForgotPassword:b+" z91o2",sectionCreateAccount:b+" z915g"};class x extends t{constructor(){super(...arguments),x.prototype.__init.call(this),x.prototype.__init2.call(this),x.prototype.__init3.call(this),x.prototype.__init4.call(this),x.prototype.__init5.call(this),x.prototype.__init6.call(this)}__init(){this.email=s()}__init2(){this.password=s()}__init3(){this.state={error:null,processing:!1,googleError:null,googleInitialized:!1,googleProcessing:!1}}componentDidMount(){w().then((()=>{this.setState({googleInitialized:!0})}))}__init4(){this.redirect=()=>{const{next:t}=this.props.query;t&&t.includes("/mailer/")?window.location.replace(window.location.origin+t):this.props.dispatch("navigate",l(t))}}__init5(){this.handleSignin=async t=>{t.preventDefault();const e=this.email&&this.email.current,s=this.password&&this.password.current;if(e&&s)try{c([{field:e,validator:g},{field:s,validator:d}]),this.setState({processing:!0,error:null});const t=await f(e.value,s.value);this.props.dispatch("user/signIn",t),this.setState({processing:!1,error:null}),this.redirect()}catch(t){this.setState({processing:!1,error:t})}}}__init6(){this.handleGoogleSignin=async t=>{t.preventDefault();try{this.setState({googleProcessing:!0,googleError:null});const t=await _();this.props.dispatch("user/googleSignIn",t),this.setState({googleProcessing:!1,googleError:null}),this.redirect()}catch(t){const e=S(t);this.setState({googleProcessing:!1,googleError:e})}}}render(){const t=this.props.query.next,s=t?"?next=".concat(encodeURIComponent(t)):"",{googleInitialized:a,googleError:n,googleProcessing:r}=this.state;return e(v,{title:"Sign In",id:this.props.id},e(i,null,e("section",{className:C.sectionGoogle,"data-section":"google"},e("form",{noValidate:!0,onSubmit:this.handleGoogleSignin},e(p,{error:n}),e(P,{id:"google-signin",title:a?"Sign in with Google":"Loading...",onClick:this.handleGoogleSignin,processing:r,disabled:!a}))),e("section",{className:C.sectionSignin,"data-section":"signin"},e("div",{className:C.separator},e("span",null,"OR")),e("form",{noValidate:!0,onSubmit:this.handleSignin,action:""},e(p,{error:this.state.error}),e(h,{ref:this.email,name:"email",type:"email",label:"Email",autocomplete:"email",error:this.state.error}),e(h,{ref:this.password,name:"password",type:"password",label:"Password",autocomplete:"current-password",error:this.state.error}),e("div",{className:C.actions},e(u,{id:"signin",title:"Sign in",processing:this.state.processing})))),e("section",{className:C.sectionForgotPassword,"data-section":"forgot"},e(m,{to:"/a/wa/forgotPassword"},"Forgot your password?")),e("section",{className:C.sectionCreateAccount,"data-section":"signup"},e("h3",{className:C.title},"Don't have an account?"),e(m,{to:"/a/wa/signup"+s,id:"create_acc",className:o.buttonGreen},"Sign up for a free account"))))}}var F=r(x,"query");export{F as default};
//# sourceMappingURL=SigninPanel.e05a1f5f.js.map
