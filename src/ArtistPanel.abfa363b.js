import{g as t,y as e,s,l as r,d as i,e as n}from"./preact.89f2d999.js";import{u as a,s as l,S as o,a as c,b as d,I as u,R as m}from"./SongsPanel.a5dde152.js";import{S as f}from"./SongsItem.0ded978c.js";import{S as p}from"./SearchBox.599c4e55.js";import{S as g}from"./Stub.619b21c6.js";import{P as h}from"./Panel.3ed0232a.js";import{u as b,bt as S,bu as F,bv as I,bw as v,a1 as y,bx as j,by as w,bz as x,bA as k,bB as N,E as A,y as P,Y as C,bC as D}from"./index.0e02c5ee.js";import"./ShowroomPlaceholder.48ae4617.js";import"./DifficultyIndicator.6b73f35d.js";const T="IntersectionObserver"in window,B=t((t=>{let{route:B,query:E,user:M,device:O,isSmallScreen:R,id:q}=t;const{artist:z,meta:L,dispatch:U}=b("artist","meta");e((()=>S({route:B,artist:z,device:O})),[z.pattern,z.filters]);const V=s(),W=s();a(V,W,"ArtistPanel");const{isDesktop:Y}=O,{hasPlus:G}=M,H=+B.artistId,J=z.artists[H]||"Unknown Artist",K=F(z.filters,""),Q=""!==K?" ".concat(K):"",X="".concat(J).concat(Q," Tabs"),[Z,$]=r(z.pattern),_=s(),tt=i((()=>t=>{clearTimeout(_.current),$(t);const e=t.replace(/\s+/g," ").trim();I(e);const s=()=>U("artist/filter/pattern",e);""===e?s():_.current=setTimeout(s,500)}),[$]),et=()=>{N(D),U("artist/filter/reset")},[st,rt]=r(null),it=z.songs.list||[],nt=!!z.loading,at=v(z.filters.instrument),lt=v(z.songs.filters.instrument),ot=0===z.pattern.length?{}:{pattern:z.pattern},ct=y({artist:J,artistId:H}),dt=j.map((t=>w(ct,t,ot))),ut=x(z.filters),mt=z.songs.hasMore,ft=s();e((()=>{try{if(ft.current&&T){const t=new IntersectionObserver((t=>{t[0].isIntersecting&&U("artist/more")}),{rootMargin:"0px 0px 300px 0px",threshold:1,root:document.getElementById("panel-artist")});return t.observe(ft.current),()=>t.disconnect()}}catch(t){console.error(t)}}),[]);const pt={tuningFilter:z.filters.tunings[z.filters.instrument]||k,instrumentFilter:z.filters.instrument,difficultyFilter:z.filters.difficulty,setTuningFilter:t=>U("artist/filter/tuning",{instrument:z.filters.instrument,tuning:t}),setInstrumentFilter:t=>{N(t),U("artist/filter/instrument",t)},setDifficultyFilter:t=>U("artist/filter/difficulty",t),difficultyFilterNA:at,isSmallScreen:R,instrumentSEOLinks:dt,activeFilter:st,onFilterClick:t=>rt(t===st?null:t)};return n(h,{title:X,id:q,listId:H,styles:l,onClick:()=>rt(null),children:[n(o,{children:[n(p,{value:Z,setValue:tt,isDesktop:Y,loading:nt,inputRef:W,placeholder:R?"Filter tabs":"Filter ".concat(J," tabs")}),n(c,pt),Y&&!G&&n(d,{page:B.page,instrumentFilter:z.filters.instrument})]}),it.length>0&&n("div",{className:l.songs,"data-list":"artist",ref:V,children:it.map((t=>n(f,{song:t,isActive:L&&L.songId===t.songId,numerated:!1,difficultyNA:lt},t.songId.toString())))}),!T&&z.songs.hasMore&&n("div",{className:l.button,children:n(A,{onClick:()=>U("artist/more"),title:"Show more",processing:!!z.loading})}),T&&n("div",{ref:ft,children:[mt&&!!z.loading&&n(P,{fill:"#777",width:35,height:35,className:C.songs})]}),!nt&&0===it.length&&n("div",{className:l.stubWrapper,children:[n(g,{id:"notfound",header:"No tabs found",headerColor:"red",icon:()=>n(u,{}),children:n(m,{usesFilters:ut,numResults:0,resetFilter:ut?et:()=>{et(),tt("")}})})]})]})}));export{B as default};
//# sourceMappingURL=ArtistPanel.abfa363b.js.map
